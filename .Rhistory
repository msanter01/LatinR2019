confint(fitCAN1)
##Linear model by Sex: 1= Male 2= Women
fitSEX <- lm(formula=mu_sbp~winter+edad, data=subset(cescas, sexo==1), weights = ponderador)
summary(fitSEX)
confint(fitSEX)
fitSEX2 <- lm(formula=mu_sbp~winter+edad, data=subset(cescas, sexo==2), weights = ponderador)
summary(fitSEX2)
confint(fitSEX2)
fitSEX3 <- lm(formula=mu_dbp~winter+edad, data=subset(cescas, sexo==1), weights = ponderador)
summary(fitSEX3)
confint(fitSEX3)
fitSEX4 <- lm(formula=mu_dbp~winter+edad, data=subset(cescas, sexo==2), weights = ponderador)
summary(fitSEX4)
confint(fitSEX4)
##Linear model by AGE GROUP: 1 35-44, 2 45-54, 3 55-64, 4 65-74
age1sys <- lm(formula=mu_sbp~winter+sexo, data=subset(cescas, agegroup==1), weights = ponderador)
summary(age1sys)
confint(age1sys)
age2sys <- lm(formula=mu_sbp~winter+sexo, data=subset(cescas, agegroup==2), weights = ponderador)
summary(age2sys)
confint(age2sys)
age3sys <- lm(formula=mu_sbp~winter+sexo, data=subset(cescas, agegroup==3), weights = ponderador)
summary(age3sys)
confint(age3sys)
age4sys <- lm(formula=mu_sbp~winter+sexo, data=subset(cescas, agegroup==4), weights = ponderador)
summary(age4sys)
confint(age4sys)
age1dis <- lm(formula=mu_dbp~winter+sexo, data=subset(cescas, agegroup==1), weights = ponderador)
summary(age1dis)
confint(age1dis)
age2dis <- lm(formula=mu_dbp~winter+sexo, data=subset(cescas, agegroup==2), weights = ponderador)
summary(age2dis)
confint(age2dis)
age3dis <- lm(formula=mu_dbp~winter+sexo, data=subset(cescas, agegroup==3), weights = ponderador)
summary(age3dis)
confint(age3dis)
age4dis <- lm(formula=mu_dbp~winter+sexo, data=subset(cescas, agegroup==4), weights = ponderador)
summary(age4dis)
confint(age4dis)
##Linear model by CV RISK
framsys0 <- lm(formula=mu_sbp~winter, data=subset(cescas, fram_risk==0 & enfcv_basal==0), weights = ponderador)
summary(framsys0)
confint(framsys0)
framsys1 <- lm(formula=mu_sbp~winter, data=subset(cescas, fram_risk==1 & enfcv_basal==0), weights = ponderador)
summary(framsys1)
confint(framsys1)
framsys2 <- lm(formula=mu_sbp~winter, data=subset(cescas, fram_risk==2 & enfcv_basal==0), weights = ponderador)
summary(framsys2)
confint(framsys2)
framdis0 <- lm(formula=mu_dbp~winter, data=subset(cescas, fram_risk==0 & enfcv_basal==0), weights = ponderador)
summary(framdis0)
confint(framdis0)
framdis1 <- lm(formula=mu_dbp~winter, data=subset(cescas, fram_risk==1 & enfcv_basal==0), weights = ponderador)
summary(framdis1)
confint(framdis1)
framdis2 <- lm(formula=mu_dbp~winter, data=subset(cescas, fram_risk==2 & enfcv_basal==0), weights = ponderador)
summary(framdis2)
confint(framdis2)
##Linear model by CV RISK CATEGORIZED (0= Low and Moderate)
fram_csys0 <- lm(formula=mu_sbp~winter, data=subset(cescas, fram_risk_c==0 & enfcv_basal==0), weights = ponderador)
summary(fram_csys0)
confint(fram_csys0)
fram_cdis0 <- lm(formula=mu_dbp~winter, data=subset(cescas, fram_risk_c==0 & enfcv_basal==0), weights = ponderador)
summary(fram_cdis0)
confint(fram_cdis0)
##Linear model by History of CVD
CVDsys <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, enfcv_basal==1), weights = ponderador)
summary(CVDsys)
confint(CVDsys)
CVDdis <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, enfcv_basal==1), weights = ponderador)
summary(CVDdis)
confint(CVDdis)
##Linear model by DIABETES
dbtsys <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, diabetes==1), weights = ponderador)
summary(dbtsys)
confint(dbtsys)
dbtsys2 <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, diabetes==0), weights = ponderador)
summary(dbtsys2)
confint(dbtsys2)
dbtdis <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, diabetes==1), weights = ponderador)
summary(dbtdis)
confint(dbtdis)
dbtdis2 <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, diabetes==0), weights = ponderador)
summary(dbtdis2)
confint(dbtdis2)
##Linear model by HYPERTENSION
htnsys <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, hypertension==1), weights = ponderador)
summary(htnsys)
confint(htnsys)
htnsys2 <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, hypertension==0), weights = ponderador)
summary(htnsys2)
confint(htnsys2)
htndis <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, hypertension==1), weights = ponderador)
summary(htndis)
confint(htndis)
htndis2 <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, hypertension==0), weights = ponderador)
summary(htndis2)
confint(htndis2)
#Linear Model for 5?C Temp increase
Bfit1 <- lm(formula=mu_sbp~Temp5C+edad+sexo, data=cescas, weights = ponderador)
summary(Bfit1)
confint(Bfit1)
Bfit2 <- lm(formula=mu_dbp~Temp5C+edad+sexo, data=cescas, weights = ponderador)
summary(Bfit2)
confint(Bfit2)
##Linear model for 5?C Temp increase  -SBP by SITE
BfitMP <- lm(formula=mu_sbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="MP"), weights = ponderador)
summary(BfitMP)
confint(BfitMP)
BfitBAR <- lm(formula=mu_sbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="BAR"), weights = ponderador)
summary(BfitBAR)
confint(BfitBAR)
BfitTEM <- lm(formula=mu_sbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="TEM"), weights = ponderador)
summary(BfitTEM)
confint(BfitTEM)
BfitCAN <- lm(formula=mu_sbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="CAN"), weights = ponderador)
summary(BfitCAN)
confint(BfitCAN)
## Linear model - for 5?C Temp increase - DBP by SITE
BfitMP1 <- lm(formula=mu_dbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="MP"), weights = ponderador)
summary(BfitMP1)
confint(BfitMP1)
BfitBAR1 <- lm(formula=mu_dbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="BAR"), weights = ponderador)
summary(BfitBAR1)
confint(BfitBAR1)
BfitTEM1 <- lm(formula=mu_dbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="TEM"), weights = ponderador)
summary(BfitTEM1)
confint(BfitTEM1)
BfitCAN1 <- lm(formula=mu_dbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="CAN"), weights = ponderador)
summary(BfitCAN1)
confint(BfitCAN1)
###### MODEL ASSUMPTIONS #####
#Link: https://data.library.virginia.edu/diagnostic-plots/
ggplot(na.exclude(cescas), aes(winter, mu_sbp))+
geom_point()
plot(fit1)
facet_grid(sitio ~ .)
plot(Bfit1)
# Scatterplot for Mean Temp - SBP
ggplot(cescas, aes(x=T2M, y=mu_sbp)) +
geom_point(aes(col=sitio)) +
geom_smooth(method="lm", se=T) +
labs(caption= "Pearson's r = -0.065 [95% CI: -0.088;-0.043, p=<0.001]",
x="Average daily outdoor temperature (?C)",
y="Systolic blood pressure (mmHg)")+
theme(legend.position = "none",
axis.title = element_text(size=18),
plot.caption = element_text(size=18, hjust=1, vjust=22))
ggsave (filename="FigA.png", plot=last_plot(), width = 10, height = 8, dpi = 600 )
# Scatterplot for Mean Temp - SBP by SITE
ggplot(cescas, aes(x=T2M, y=mu_sbp)) +
geom_point(aes(col=sitio)) +
geom_smooth(method="lm", se=T) +
labs(caption= "",
x="Average daily outdoor temperature (?C)",
y="Systolic blood pressure (mmHg)")+
theme(legend.position = "none",
axis.title = element_text(size=16))+
facet_grid(city ~ .)
ggsave (filename="FigB.png", plot=last_plot(), width = 10, height = 8, dpi = 600 )
# Scatterplot for Mean Temp - DBP
ggplot(cescas, aes(x=T2M, y=mu_dbp)) +
geom_point(aes(col=sitio)) +
geom_smooth(method="lm", se=T) +
labs(caption= "Pearson R= -0.147 [95% CI: -0.169;-0.125, p=<0.001]",
x="Average daily outdoor temperature (?C)",
y="Diastolic blood pressure (mmHg)")+
theme(legend.position = "none",
axis.title = element_text(size=18),
plot.caption = element_text(size=18, hjust=1, vjust=22))
ggsave (filename="FigC.png", plot=last_plot(), width = 10, height = 8, dpi = 600 )
#Scatterplot for Mean Temp - DBP By SITE
ggplot(cescas, aes(x=T2M, y=mu_dbp)) +
geom_point(aes(col=sitio)) +
geom_smooth(method="lm", se=T) +
labs(caption= "",
x="Average daily outdoor temperature (?C)",
y="Diastolic blood pressure (mmHg)")+
theme(legend.position = "none",
axis.title = element_text(size=16))+
facet_grid(city ~ .)
ggsave (filename="FigD.png", plot=last_plot(), width = 10, height = 8, dpi = 600 )
ggsave (filename="FigD.png", plot=last_plot(), width = 10, height = 8, dpi = 600 )
View(table_dates)
View(table_dbp)
#setwd ("C://Users//Usuario//Dropbox//paper_estacionalidad//2.data")
setwd ("C://Users//Santiago//Dropbox//paper_estacionalidad//2.data")
##### PACKAGES #####
library(ggplot2)
library(survey)
library(dplyr)
library(funModeling)
library(lme4)
library(ggthemes)
library(broom)
##### DATABASE #####
cescastot <- read.csv("cescas_temp.csv", header=T)
cescas <- subset(cescastot, select= c(date_bp, subjid, edad, sexo, sitio, pais, str, id, ponderador, agegroup, mu_sbp, mu_dbp, hypertension, bmi, overweight, obesity, diabetes, enfcv, fram_risk, T2M ))
write.csv(cescas, file="seasonality.csv")
#####  VARIABLES #####
cescas$month <- format(as.Date(cescas$date_bp), "%m")
cescas$city <- cescas$sitio
levels(cescas$city)[levels(cescas$city)=="BAR"]<- "Bariloche"
levels(cescas$city)[levels(cescas$city)=="CAN"]<- "Canelones"
levels(cescas$city)[levels(cescas$city)=="MP"]<- "Marcos Paz"
levels(cescas$city)[levels(cescas$city)=="TEM"]<- "Temuco"
cescas$city <- ordered(cescas$city, levels = c("Bariloche", "Marcos Paz", "Canelones", "Temuco"))
#Creating Numeric Variable for 5?C increases in temperature
cescas$Temp5C <- cut(cescas$T2M, seq(-10, 40, 5))
levels(cescas$Temp5C)
cescas$Temp5C <- recode(cescas$Temp5C, "(-10,-5]"=1, "(-5,0]"=2,   "(0,5]"=3,  "(5,10]"=4,   "(10,15]"=5,  "(15,20]"=6,  "(20,25]"=7,  "(25,30]"=8,  "(30,35]"=9,  "(35,40]"=10 )
#Aggregate Low an dmoderate CV Risk (0=Low and Modearte, 2=High)
cescas$fram_risk_c <- recode(cescas$fram_risk, '1'=0, '0'=0, '2'=2)
#Creating Seasonality Variable Summer=0 Winter=1
cescas$winter <- NA
cescas$winter[cescas$month=="12" | cescas$month=="01" |cescas$month=="02"] <- 0
cescas$winter[cescas$month=="06" | cescas$month=="07" |cescas$month=="08"] <- 1
cescas$winter <- factor(cescas$winter,
levels = c("0","1"),
labels = c("Summer", "Winter"))
#Creating Season Variable Summer=1 Fall=2 Winter=3 Spring=4
cescas$season <- NA
cescas$season[cescas$month=="12" | cescas$month=="01" |cescas$month=="02"] <- 1
cescas$season[cescas$month=="03" | cescas$month=="04" |cescas$month=="05"] <- 2
cescas$season[cescas$month=="06" | cescas$month=="07" |cescas$month=="08"] <- 3
cescas$season[cescas$month=="09" | cescas$month=="10" |cescas$month=="11"] <- 4
cescas$season <- factor(cescas$season,
levels = c("1","2","3","4"),
labels = c("Summer", "Fall", "Winter", "Spring"))
##### EXPLORATORY DATA ANALYSYS #####
# df <- df_status(cescas)
# dfnum <- profiling_num(cescas)
# freq(cescas)
#
# eda <- subset(cescas, is.na(cescas$date_bp))
##### DATA PRE-PROCESSING #####
#Outlier identification
sbp_outlier_count <- cescas$mu_sbp[cescas$mu_sbp>250 | cescas$mu_sbp<60]
dbp_outlier_count <- cescas$mu_dbp[cescas$mu_dbp<40 | cescas$mu_dbp>150]
##Analysis restrictions
#Removing participant withouth BP Messurement
cescas <- subset(cescas, !is.na(cescas$date_bp))
#####  Survey complex design #####
cescassvy <- svydesign(id=~subjid, weights=~ponderador, strata=~str, data=cescas)
##### ANALYSIS #####
#95%CI for Overall Weighted Mean BP
svyttest(mu_sbp~0, cescassvy, na.rm=T)
svyttest(mu_dbp~0, cescassvy, na.rm=T)
#Weighted Mean BP by Season
table1 <- as.matrix(svyby(~mu_sbp+mu_dbp, ~season, design = cescassvy, svymean, ci=T, level=0.95, na.rm=T ))
#Weighted Mean BP for Summer and Winter
svyby(~mu_sbp+mu_dbp, ~winter, design = cescassvy, svymean, ci=T, level=0.95, na.rm=T )
svyttest(mu_sbp~winter, cescassvy)
svyttest(mu_dbp~winter, cescassvy)
#Summarizing values
#Table to see number of participant each day
table_dates <- cescas %>%
group_by(date_bp) %>%
summarise(total = n())
table_sbp <- cescas %>%
group_by(month) %>%
summarise(mean = mean(mu_sbp, na.rm=T),
sd = sd(mu_sbp, na.rm=T),
total = n())
table_dbp <- cescas %>%
group_by(month) %>%
summarise(mean = mean(mu_dbp, na.rm=T),
sd = sd(mu_dbp, na.rm=T),
total = n())
##Calculating Pearson's product-moment correlation from https://scientificallysound.org/2016/04/04/r-pearson-correlation/
cor.test(cescas$T2M, cescas$mu_sbp, method = "pearson", conf.level = 0.95)
cor.test(cescas$T2M, cescas$mu_dbp, method = "pearson", conf.level = 0.95)
##Calculating Pearson's product-moment correlation SBP by SITE
cor.test(cescas$T2M[cescas$sitio=="MP"], cescas$mu_sbp[cescas$sitio=="MP"], method = "pearson", conf.level = 0.95)
cor.test(cescas$T2M[cescas$sitio=="BAR"], cescas$mu_sbp[cescas$sitio=="BAR"], method = "pearson", conf.level = 0.95)
cor.test(cescas$T2M[cescas$sitio=="TEM"], cescas$mu_sbp[cescas$sitio=="TEM"], method = "pearson", conf.level = 0.95)
cor.test(cescas$T2M[cescas$sitio=="CAN"], cescas$mu_sbp[cescas$sitio=="CAN"], method = "pearson", conf.level = 0.95)
##Calculating Pearson's product-moment correlation DBP by SITE
cor.test(cescas$T2M[cescas$sitio=="MP"], cescas$mu_dbp[cescas$sitio=="MP"], method = "pearson", conf.level = 0.95)
cor.test(cescas$T2M[cescas$sitio=="BAR"], cescas$mu_dbp[cescas$sitio=="BAR"], method = "pearson", conf.level = 0.95)
cor.test(cescas$T2M[cescas$sitio=="TEM"], cescas$mu_dbp[cescas$sitio=="TEM"], method = "pearson", conf.level = 0.95)
cor.test(cescas$T2M[cescas$sitio=="CAN"], cescas$mu_dbp[cescas$sitio=="CAN"], method = "pearson", conf.level = 0.95)
##Linear model - OVERALL
fit1 <- lm(formula=mu_sbp~winter+edad+sexo, data=cescas, weights = ponderador)
summary(fit1)
confint(fit1)
fit2 <- lm(formula=mu_dbp~winter+edad+sexo, data=cescas, weights = ponderador)
summary(fit2)
confint(fit2)
##Linear model - SBP by SITE
fitMP <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, sitio=="MP"), weights = ponderador)
summary(fitMP)
confint(fitMP)
fitBAR <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, sitio=="BAR"), weights = ponderador)
summary(fitBAR)
confint(fitBAR)
fitTEM <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, sitio=="TEM"), weights = ponderador)
summary(fitTEM)
confint(fitTEM)
fitCAN <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, sitio=="CAN"), weights = ponderador)
summary(fitCAN)
confint(fitCAN)
## Linear model - DBP by SITE
fitMP1 <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, sitio=="MP"), weights = ponderador)
summary(fitMP1)
confint(fitMP1)
fitBAR1 <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, sitio=="BAR"), weights = ponderador)
summary(fitBAR1)
confint(fitBAR1)
fitTEM1 <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, sitio=="TEM"), weights = ponderador)
summary(fitTEM1)
confint(fitTEM1)
fitCAN1 <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, sitio=="CAN"), weights = ponderador)
summary(fitCAN1)
confint(fitCAN1)
##Linear model by Sex: 1= Male 2= Women
fitSEX <- lm(formula=mu_sbp~winter+edad, data=subset(cescas, sexo==1), weights = ponderador)
summary(fitSEX)
confint(fitSEX)
fitSEX2 <- lm(formula=mu_sbp~winter+edad, data=subset(cescas, sexo==2), weights = ponderador)
summary(fitSEX2)
confint(fitSEX2)
fitSEX3 <- lm(formula=mu_dbp~winter+edad, data=subset(cescas, sexo==1), weights = ponderador)
summary(fitSEX3)
confint(fitSEX3)
fitSEX4 <- lm(formula=mu_dbp~winter+edad, data=subset(cescas, sexo==2), weights = ponderador)
summary(fitSEX4)
confint(fitSEX4)
##Linear model by AGE GROUP: 1 35-44, 2 45-54, 3 55-64, 4 65-74
age1sys <- lm(formula=mu_sbp~winter+sexo, data=subset(cescas, agegroup==1), weights = ponderador)
summary(age1sys)
confint(age1sys)
age2sys <- lm(formula=mu_sbp~winter+sexo, data=subset(cescas, agegroup==2), weights = ponderador)
summary(age2sys)
confint(age2sys)
age3sys <- lm(formula=mu_sbp~winter+sexo, data=subset(cescas, agegroup==3), weights = ponderador)
summary(age3sys)
confint(age3sys)
age4sys <- lm(formula=mu_sbp~winter+sexo, data=subset(cescas, agegroup==4), weights = ponderador)
summary(age4sys)
confint(age4sys)
age1dis <- lm(formula=mu_dbp~winter+sexo, data=subset(cescas, agegroup==1), weights = ponderador)
summary(age1dis)
confint(age1dis)
age2dis <- lm(formula=mu_dbp~winter+sexo, data=subset(cescas, agegroup==2), weights = ponderador)
summary(age2dis)
confint(age2dis)
age3dis <- lm(formula=mu_dbp~winter+sexo, data=subset(cescas, agegroup==3), weights = ponderador)
summary(age3dis)
confint(age3dis)
age4dis <- lm(formula=mu_dbp~winter+sexo, data=subset(cescas, agegroup==4), weights = ponderador)
summary(age4dis)
confint(age4dis)
##Linear model by CV RISK
framsys0 <- lm(formula=mu_sbp~winter, data=subset(cescas, fram_risk==0 & enfcv_basal==0), weights = ponderador)
summary(framsys0)
confint(framsys0)
framsys1 <- lm(formula=mu_sbp~winter, data=subset(cescas, fram_risk==1 & enfcv_basal==0), weights = ponderador)
summary(framsys1)
confint(framsys1)
framsys2 <- lm(formula=mu_sbp~winter, data=subset(cescas, fram_risk==2 & enfcv_basal==0), weights = ponderador)
summary(framsys2)
confint(framsys2)
framdis0 <- lm(formula=mu_dbp~winter, data=subset(cescas, fram_risk==0 & enfcv_basal==0), weights = ponderador)
summary(framdis0)
confint(framdis0)
framdis1 <- lm(formula=mu_dbp~winter, data=subset(cescas, fram_risk==1 & enfcv_basal==0), weights = ponderador)
summary(framdis1)
confint(framdis1)
framdis2 <- lm(formula=mu_dbp~winter, data=subset(cescas, fram_risk==2 & enfcv_basal==0), weights = ponderador)
summary(framdis2)
confint(framdis2)
##Linear model by CV RISK CATEGORIZED (0= Low and Moderate)
fram_csys0 <- lm(formula=mu_sbp~winter, data=subset(cescas, fram_risk_c==0 & enfcv_basal==0), weights = ponderador)
summary(fram_csys0)
confint(fram_csys0)
fram_cdis0 <- lm(formula=mu_dbp~winter, data=subset(cescas, fram_risk_c==0 & enfcv_basal==0), weights = ponderador)
summary(fram_cdis0)
confint(fram_cdis0)
##Linear model by History of CVD
CVDsys <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, enfcv_basal==1), weights = ponderador)
summary(CVDsys)
confint(CVDsys)
CVDdis <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, enfcv_basal==1), weights = ponderador)
summary(CVDdis)
confint(CVDdis)
##Linear model by DIABETES
dbtsys <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, diabetes==1), weights = ponderador)
summary(dbtsys)
confint(dbtsys)
dbtsys2 <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, diabetes==0), weights = ponderador)
summary(dbtsys2)
confint(dbtsys2)
dbtdis <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, diabetes==1), weights = ponderador)
summary(dbtdis)
confint(dbtdis)
dbtdis2 <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, diabetes==0), weights = ponderador)
summary(dbtdis2)
confint(dbtdis2)
##Linear model by HYPERTENSION
htnsys <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, hypertension==1), weights = ponderador)
summary(htnsys)
confint(htnsys)
htnsys2 <- lm(formula=mu_sbp~winter+edad+sexo, data=subset(cescas, hypertension==0), weights = ponderador)
summary(htnsys2)
confint(htnsys2)
htndis <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, hypertension==1), weights = ponderador)
summary(htndis)
confint(htndis)
htndis2 <- lm(formula=mu_dbp~winter+edad+sexo, data=subset(cescas, hypertension==0), weights = ponderador)
summary(htndis2)
confint(htndis2)
#Linear Model for 5?C Temp increase
Bfit1 <- lm(formula=mu_sbp~Temp5C+edad+sexo, data=cescas, weights = ponderador)
summary(Bfit1)
confint(Bfit1)
Bfit2 <- lm(formula=mu_dbp~Temp5C+edad+sexo, data=cescas, weights = ponderador)
summary(Bfit2)
confint(Bfit2)
##Linear model for 5?C Temp increase  -SBP by SITE
BfitMP <- lm(formula=mu_sbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="MP"), weights = ponderador)
summary(BfitMP)
confint(BfitMP)
BfitBAR <- lm(formula=mu_sbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="BAR"), weights = ponderador)
summary(BfitBAR)
confint(BfitBAR)
BfitTEM <- lm(formula=mu_sbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="TEM"), weights = ponderador)
summary(BfitTEM)
confint(BfitTEM)
BfitCAN <- lm(formula=mu_sbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="CAN"), weights = ponderador)
summary(BfitCAN)
confint(BfitCAN)
## Linear model - for 5?C Temp increase - DBP by SITE
BfitMP1 <- lm(formula=mu_dbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="MP"), weights = ponderador)
summary(BfitMP1)
confint(BfitMP1)
BfitBAR1 <- lm(formula=mu_dbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="BAR"), weights = ponderador)
summary(BfitBAR1)
confint(BfitBAR1)
BfitTEM1 <- lm(formula=mu_dbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="TEM"), weights = ponderador)
summary(BfitTEM1)
confint(BfitTEM1)
BfitCAN1 <- lm(formula=mu_dbp~Temp5C+edad+sexo, data=subset(cescas, sitio=="CAN"), weights = ponderador)
summary(BfitCAN1)
confint(BfitCAN1)
###### MODEL ASSUMPTIONS #####
#Link: https://data.library.virginia.edu/diagnostic-plots/
ggplot(na.exclude(cescas), aes(winter, mu_sbp))+
geom_point()
plot(fit1)
plot(fit2)
ggplot(cescas, aes(Temp5C, mu_sbp, colour=sitio))+
geom_point()+
facet_grid(sitio ~ .)
plot(Bfit1)
plot(Bfit2)
##### GRAPHS #####
options(scipen=999)  # turn-off scientific notation like 1e+48
# Scatterplot for Mean Temp - SBP
ggplot(cescas, aes(x=T2M, y=mu_sbp)) +
geom_point(aes(col=sitio)) +
geom_smooth(method="lm", se=T) +
labs(caption= "Pearson's r = -0.065 [95% CI: -0.088;-0.043, p=<0.001]",
x="Average daily outdoor temperature (?C)",
y="Systolic blood pressure (mmHg)")+
theme(legend.position = "none",
axis.title = element_text(size=18),
plot.caption = element_text(size=18, hjust=1, vjust=22))
ggsave (filename="FigA.png", plot=last_plot(), width = 10, height = 8, dpi = 600 )
# Scatterplot for Mean Temp - SBP by SITE
ggplot(cescas, aes(x=T2M, y=mu_sbp)) +
geom_point(aes(col=sitio)) +
geom_smooth(method="lm", se=T) +
labs(caption= "",
x="Average daily outdoor temperature (?C)",
y="Systolic blood pressure (mmHg)")+
theme(legend.position = "none",
axis.title = element_text(size=16))+
facet_grid(city ~ .)
ggsave (filename="FigB.png", plot=last_plot(), width = 10, height = 8, dpi = 600 )
# Scatterplot for Mean Temp - DBP
ggplot(cescas, aes(x=T2M, y=mu_dbp)) +
geom_point(aes(col=sitio)) +
geom_smooth(method="lm", se=T) +
labs(caption= "Pearson R= -0.147 [95% CI: -0.169;-0.125, p=<0.001]",
x="Average daily outdoor temperature (?C)",
y="Diastolic blood pressure (mmHg)")+
theme(legend.position = "none",
axis.title = element_text(size=18),
plot.caption = element_text(size=18, hjust=1, vjust=22))
ggsave (filename="FigC.png", plot=last_plot(), width = 10, height = 8, dpi = 600 )
#Scatterplot for Mean Temp - DBP By SITE
ggplot(cescas, aes(x=T2M, y=mu_dbp)) +
geom_point(aes(col=sitio)) +
geom_smooth(method="lm", se=T) +
labs(caption= "",
x="Average daily outdoor temperature (?C)",
y="Diastolic blood pressure (mmHg)")+
theme(legend.position = "none",
axis.title = element_text(size=16))+
facet_grid(city ~ .)
ggsave (filename="FigD.png", plot=last_plot(), width = 10, height = 8, dpi = 600 )
# Scatterplot for Mean Temp - SBP
ggplot(cescas, aes(x=T2M, y=mu_sbp)) +
geom_point(aes(col=sitio)) +
geom_smooth(method="lm", se=T) +
labs(caption= "Pearson's r = -0.065 [95% CI: -0.088;-0.043, p=<0.001]",
x="Average daily outdoor temperature (?C)",
y="Systolic blood pressure (mmHg)")+
theme(legend.position = "none",
axis.title = element_text(size=18),
plot.caption = element_text(size=18, hjust=1, vjust=22))
